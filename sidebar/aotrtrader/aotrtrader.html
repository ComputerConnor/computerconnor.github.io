<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trade Value Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .trade-area { display: flex; gap: 20px; margin-bottom: 20px; }
    .box { width: 300px; min-height: 200px; border: 2px dashed #aaa; padding: 10px; }
    .item { width: 50px; height: 50px; cursor: grab; border:3px solid transparent; }
    .rarity-mythical { border-color:#e53935; }
    .rarity-legendary { border-color:#fdd835; }
    .rarity-epic { border-color:#8e24aa; }
    .rarity-rare { border-color:#1e88e5; }
    .rarity-common { border-color:#9e9e9e; }
    .rarity-uncommon { border-color:lawngreen; }
    .rarity-event {border-color:orange; }
    .item-wrap { width: 60px; text-align: center; }
    .caption { font-size: 11px; line-height: 1.1; word-wrap: break-word; margin-top: 2px; }
    .grid { display: grid; grid-template-columns: repeat(10, 60px); gap: 5px; }
    select { margin-bottom: 10px; }
    .value { font-size: 18px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Trade Value Calculator</h1>

  <div class="trade-area">
    <div>
      <h3>Your Trade</h3>
      <div id="tradeA" class="box"></div>
      <div class="value">Value: <span id="valueA">0</span></div>
    </div>
    <div>
      <h3>Their Trade</h3>
      <div id="tradeB" class="box"></div>
      <div class="value">Value: <span id="valueB">0</span></div>
    </div>
  </div>

  <h3>Item Pool</h3>
  <select id="categorySelect">
    <option value="all">All</option>
    <option value="artifacts">Artifacts</option>
    <option value="cosmetics">Cosmetics</option>
    <option value="families">Families</option>
    <option value="gamepasses">Gamepasses</option>
    <option value="market_items">Market Items</option>
    <option value="perks">Perks</option>
    <option value="serums">Serums</option>
    <option value="shards">Shards</option>
    <option value="titan_skins">Titan Skins</option>
    <option value="weapons">Weapons</option>
  </select>
  <br />
  <input id="searchInput" type="text" placeholder="Search items..." style="margin:8px 0; padding:4px; width:200px;" />

  <div id="pool" class="grid"></div>

  <script>
    // Values are stored internally in SCROLLS (base unit)
// Use valueType: 'scrolls' or 'keys' when defining items
//https://www.aotrvalue.com/missing.png
const items = [
  //artifacts
  { id: 1, name: "Scars", category: "artifacts", rarity: "mythical", value: 10, valueType: "keys", img: "https://www.aotrvalue.com/scars.png" },
  { id: 2, name: "Scarf", category: "artifacts", rarity: "mythical", value: 10, valueType: "keys", img: "https://www.aotrvalue.com/scarf.png" },
  { id: 3, name: "Hoodie", category: "artifacts", rarity: "legendary", value: 2, valueType: "keys", img: "https://www.aotrvalue.com/hoodie.png" },
  
  //no value yet
  { id: 4, name: "Young", category: "artifacts", rarity: "legendary", value: 1, valueType: "keys", img: "https://www.aotrvalue.com/young.png" },
  
  //cosmetics
  { id: 4, name: "Bambi Wings", category: "cosmetics", rarity: "legendary", min: 9900, max: 10200, valueType: "scrolls", img: "https://www.aotrvalue.com/bambi.png" },
  { id: 4, name: "Ulq Wings", category: "cosmetics", rarity: "legendary", value: 8700, valueType: "scrolls", img: "https://www.aotrvalue.com/ulqwings.png" },
  { id: 4, name: "Toji's Attire", category: "cosmetics", rarity: "legendary", value: 10800, valueType: "scrolls", img: "https://www.aotrvalue.com/toji.png" },
  { id: 4, name: "Primera's Attire", category: "cosmetics", rarity: "legendary", value: 4200, valueType: "scrolls", img: "https://www.aotrvalue.com/primera.png" },
  { id: 4, name: "Mahoraga's Wheel", category: "cosmetics", rarity: "epic", value: 2200, valueType: "scrolls", img: "https://www.aotrvalue.com/maho.png" },
  { id: 4, name: "Cursed Markings", category: "cosmetics", rarity: "legendary", value: 2000, valueType: "scrolls", img: "https://www.aotrvalue.com/sukunamarking.png" },
  { id: 4, name: "Captain's Attire", category: "cosmetics", rarity: "epic", value: 1000, valueType: "scrolls", img: "https://www.aotrvalue.com/captain.png" },
  { id: 4, name: "Quincy's Attire", category: "cosmetics", rarity: "epic", value: 350, valueType: "scrolls", img: "https://www.aotrvalue.com/quincy.png" },
  { id: 4, name: "Geto's Attire", category: "cosmetics", rarity: "epic", min: 240, max: 250, valueType: "scrolls", img: "https://www.aotrvalue.com/getto.png" },
  { id: 4, name: "Vizard's Mask", category: "cosmetics", rarity: "mythical", min: 225, max: 250, valueType: "scrolls", img: "https://www.aotrvalue.com/vizardmask.png" },
  { id: 4, name: "Gojo's Blindfold", category: "cosmetics", rarity: "uncommon", value: 30, valueType: "scrolls", img: "https://www.aotrvalue.com/missing.png" },
  { id: 4, name: "Utahime's Attire", category: "cosmetics", rarity: "uncommon", value: 30, valueType: "scrolls", img: "https://www.aotrvalue.com/utahime.png" },
  { id: 4, name: "Toshiro Scarf", category: "cosmetics", rarity: "epic", min: 10, max: 15, valueType: "scrolls", img: "https://www.aotrvalue.com/captain.png" },
  { id: 4, name: "Giyuu's Attire(+)", category: "cosmetics", rarity: "epic", value: 35, valueType: "scrolls", img: "https://www.aotrvalue.com/quincy.png" },
  { id: 4, name: "Axe Head", category: "cosmetics", rarity: "event", value: 100, valueType: "scrolls", img: "https://www.aotrvalue.com/missing.png" },
  { id: 4, name: "Green Aura With Flies", category: "cosmetics", rarity: "event", value: 70, valueType: "scrolls", img: "https://www.aotrvalue.com/missing.png" },
  { id: 4, name: "Cracked Shell", category: "cosmetics", rarity: "event", min: 10, max: 15, valueType: "scrolls", img: "https://www.aotrvalue.com/missing.png" },
  { id: 4, name: "Blade Head", category: "cosmetics", rarity: "event", min: 40, max: 45,  valueType: "scrolls", img: "https://www.aotrvalue.com/missing.png" },

  //families
  { id: 5, name: "Fritz", category: "families", rarity: "mythical", value: 1450, valueType: "scrolls", img: "https://www.aotrvalue.com/fritz.png" },
  { id: 6, name: "Helos", category: "families", rarity: "mythical", min:2200, max:2300, valueType: "scrolls", img: "https://www.aotrvalue.com/helos.png" },
  { id: 7, name: "Ackerman", category: "families", rarity: "legendary", value: 30, valueType: "scrolls", img: "https://www.aotrvalue.com/ackerman.png" },
  { id: 8, name: "Yeager", category: "families", rarity: "legendary", value: 20, valueType: "scrolls", img: "https://www.aotrvalue.com/yeager.png" },
  { id: 9, name: "Reiss", category: "families", rarity: "legendary", value: 10, valueType: "scrolls", img: "https://www.aotrvalue.com/reiss.png" },
  { id: 10, name: "Arlet", category: "families", rarity: "epic", min: 4, max:5, valueType: "scrolls", img: "https://www.aotrvalue.com/arlert.png" },
  { id: 11, name: "Leonhart", category: "families", rarity: "epic", min:8, max:10, valueType: "scrolls", img: "https://www.aotrvalue.com/leonhart.png" },

  //gamepasses
  { id: 12, name: "12 FPS", category: "gamepasses", rarity: "legendary", value: 20, valueType: "keys", img: "https://www.aotrvalue.com/missing.png" },

  //market_items
  { id: 12, name: "Luck Boost 2HR", category: "market_items", rarity: "legendary", value: 20, valueType: "keys", img: "https://www.aotrvalue.com/luckboost.png" },
  { id: 13, name: "Gold Boost 2HR", category: "market_items", rarity: "legendary", value: 14, valueType: "keys", img: "https://www.aotrvalue.com/goldboost.png" },
  { id: 14, name: "XP Boost 2HR", category: "market_items", rarity: "legendary", value: 7, valueType: "keys", img: "https://www.aotrvalue.com/xpboost.png" },
  { id: 15, name: "Prestige Scroll", category: "market_items", rarity: "rare", value: 3, valueType: "keys", img: "https://www.aotrvalue.com/scroll.png" },
  { id: 16, name: "Key", category: "market_items", rarity: "epic", value: 1, valueType: "keys", img: "https://www.aotrvalue.com/key.png" },

  //perks
  { id: 17, name: "Founder's Blessing", category: "perks", rarity: "mythical", value: 20, valueType: "keys", img: "https://www.aotrvalue.com/bodyperk.png" },
  { id: 18, name: "Maximum FIrepower", category: "perks", rarity: "mythical", value: 20, valueType: "keys", img: "https://www.aotrvalue.com/bodyperk.png" },
  { id: 19, name: "Heavenly Restriction", category: "perks", rarity: "mythical", value: 10, valueType: "keys", img: "https://www.aotrvalue.com/bodyperk.png" },
  { id: 20, name: "Art of War", category: "perks", rarity: "mythical", value: 30, valueType: "keys", img: "https://www.aotrvalue.com/offenseperk.png" },
  { id: 21, name: "Black Flash", category: "perks", rarity: "mythical", value: 25, valueType: "keys", img: "https://www.aotrvalue.com/offenseperk.png" },
  { id: 22, name: "Everlasting Flame", category: "perks", rarity: "mythical", value: 10, valueType: "keys", img: "https://www.aotrvalue.com/offenseperk.png" },
  { id: 23, name: "Kengo", category: "perks", rarity: "mythical", value: 20, valueType: "keys", img: "https://www.aotrvalue.com/offenseperk.png" },
  { id: 24, name: "Adaptation", category: "perks", rarity: "mythical", value: 20, valueType: "keys", img: "https://www.aotrvalue.com/defenceperk.png" },
  { id: 25, name: "Immortal", category: "perks", rarity: "mythical", value: 18, valueType: "keys", img: "https://www.aotrvalue.com/defenceperk.png" },
  { id: 26, name: "Explosive Forture", category: "perks", rarity: "mythical", value: 15, valueType: "keys", img: "https://www.aotrvalue.com/supportperk.png" },
  { id: 27, name: "Font of Inspiration", category: "perks", rarity: "mythical", value: 20, valueType: "keys", img: "https://www.aotrvalue.com/supportperk.png" },
  { id: 28, name: "Soulfeed", category: "perks", rarity: "mythical", value: 15, valueType: "keys", img: "https://www.aotrvalue.com/supportperk.png" },
  { id: 29, name: "Tatsujin", category: "perks", rarity: "mythical", value: 15, valueType: "keys", img: "https://www.aotrvalue.com/supportperk.png" },
  
  //serums
  { id: 30, name: "Armored Serum", category: "serums", rarity: "mythical", value: 25, valueType: "keys", img: "https://www.aotrvalue.com/armourserum.png" },
  { id: 31, name: "Female Serum", category: "serums", rarity: "mythical", value: 30, valueType: "keys", img: "https://www.aotrvalue.com/femaleserum.png" },
  { id: 32, name: "Attack Serum", category: "serums", rarity: "mythical", value: 20, valueType: "keys", img: "https://www.aotrvalue.com/attackserum.png" },
  
  //shards
  { id: 33, name: "Female Shard", category: "shards", rarity: "legendary", min: 4, max: 5, valueType: "keys", img: "https://www.aotrvalue.com/missing.png" },
  { id: 34, name: "Armored Shard", category: "shards", rarity: "legendary", value: 6, valueType: "keys", img: "https://www.aotrvalue.com/ArmoredShard.png" },
  { id: 35, name: "Attack Shard", category: "shards", rarity: "legendary", value: 2, valueType: "keys", img: "https://www.aotrvalue.com/ashard.png" },
  
//titan_skins
  { id: 33, name: "Oni", category: "titan_skins", rarity: "mythical", value: 1200, valueType: "scrolls", img: "https://www.aotrvalue.com/onieren.png" },
  { id: 33, name: "Jotunn", category: "titan_skins", rarity: "mythical", min: 300, max:320, valueType: "scrolls", img: "https://www.aotrvalue.com/jotunn.png" },
  { id: 33, name: "Deus", category: "titan_skins", rarity: "mythical", min: 4, max: 5, valueType: "keys", img: "https://www.aotrvalue.com/deus.png" },
  { id: 33, name: "Moai", category: "titan_skins", rarity: "mythical", value: 200, valueType: "scrolls", img: "https://www.aotrvalue.com/moai.png" },
  { id: 33, name: "Equinox Moon", category: "titan_skins", rarity: "mythical", min: 4, max: 5, valueType: "keys", img: "https://www.aotrvalue.com/EquinoxMoon.png" },
  { id: 33, name: "Grumpy", category: "titan_skins", rarity: "mythical", min: 4, max: 5, valueType: "keys", img: "https://www.aotrvalue.com/grumpy.png" },
  { id: 33, name: "Forsaken", category: "titan_skins", rarity: "mythical", value: 130, valueType: "scrolls", img: "https://www.aotrvalue.com/missing.png" },

//weapons

];

    const rarityOrder = ["mythical", "event", "legendary", "epic", "rare", "uncommon", "common"];

    // Convert any value to scrolls (base unit)
function toScrolls(value, type) {
  return type === "keys" ? value / 3 : value;
}

// Accept either a single value or a range (min/max)
function normalizeValue(item) {
  if (item.min !== undefined && item.max !== undefined) {
    return {
      min: toScrolls(item.min, item.valueType),
      max: toScrolls(item.max, item.valueType)
    };
  }
  const v = toScrolls(item.value, item.valueType);
  return { min: v, max: v };
}

// Format display as range "A-B scrolls / C-D keys"
function formatRange(minScrolls, maxScrolls) {
  const minKeys = minScrolls * 3;
  const maxKeys = maxScrolls * 3;
  if (minScrolls === maxScrolls) {
    return `${minScrolls} scrolls / ${minKeys} keys`;
  }
  return `${minScrolls}-${maxScrolls} scrolls / ${minKeys}-${maxKeys} keys`;
}

function renderPool(category, term = "") {
      const pool = document.getElementById("pool");
      pool.innerHTML = "";

      const filtered = items
        .filter(i => (category === "all" || i.category === category))
        .filter(i => (i.name || "").toLowerCase().includes(term.toLowerCase()))
        .sort((a, b) => rarityOrder.indexOf(a.rarity) - rarityOrder.indexOf(b.rarity) || (b.value||b.max||0) - (a.value||a.max||0));

      filtered.forEach(item => {
        const wrap = document.createElement("div");
        wrap.className = "item-wrap";

        const img = document.createElement("img");
        img.src = item.img;
        img.className = "item";

        const range = normalizeValue(item);
        img.dataset.baseMin = range.min;
        img.dataset.baseMax = range.max;
        img.dataset.min = range.min;
        img.dataset.max = range.max;
        img.dataset.qty = 1;
        img.title = formatRange(range.min, range.max);
        img.classList.add(`rarity-${item.rarity}`);

        const caption = document.createElement("div");
        caption.className = "caption";
        caption.textContent = item.name || "Item";

        wrap.appendChild(img);
        wrap.appendChild(caption);
        pool.appendChild(wrap);
      });
    }

    function calculate(boxId, valueId) {
      const box = document.getElementById(boxId);
      let minTotal = 0;
      let maxTotal = 0;
      box.querySelectorAll(".item").forEach(el => {
        minTotal += Number(el.dataset.min);
        maxTotal += Number(el.dataset.max);
      });
      document.getElementById(valueId).textContent = formatRange(minTotal, maxTotal);
    }

    // Click to remove items from trade boxes
    // Click item to set quantity
    function enableQuantity(boxId, valueId) {
      const box = document.getElementById(boxId);
      box.addEventListener("click", (e) => {
        if (!e.target.classList.contains("item")) return;
        const el = e.target;
        const qty = Number(prompt("Enter quantity:", el.dataset.qty || 1));
        if (!qty || qty < 1) return;
        el.dataset.qty = qty;
        const min = Number(el.dataset.baseMin) * qty;
        const max = Number(el.dataset.baseMax) * qty;
        el.dataset.min = min;
        el.dataset.max = max;
        el.title = formatRange(min, max);
        calculate(boxId, valueId);
      });
    }

    // Pool clones; dropping back into pool deletes (acts like remove)
    new Sortable(pool, {
      group: { name: "shared", pull: "clone", put: true },
      sort: false,
      animation: 150,
      onAdd: (evt) => {
        if (evt.from.id !== "pool") evt.item.remove();
      }
    });
    new Sortable(tradeA, { group: "shared", animation: 150, onAdd: () => calculate("tradeA","valueA"), onRemove: () => calculate("tradeA","valueA"), onUpdate: () => calculate("tradeA","valueA") });
    new Sortable(tradeB, { group: "shared", animation: 150, onAdd: () => calculate("tradeB","valueB"), onRemove: () => calculate("tradeB","valueB"), onUpdate: () => calculate("tradeB","valueB") });

    const categorySelect = document.getElementById("categorySelect");
    const searchInput = document.getElementById("searchInput");

    function refreshPool() {
      renderPool(categorySelect.value, searchInput.value);
    }

    categorySelect.addEventListener("change", refreshPool);
    searchInput.addEventListener("input", refreshPool);

    enableQuantity("tradeA", "valueA");
    enableQuantity("tradeB", "valueB");

    renderPool("all");
  </script>
</body>
</html>
